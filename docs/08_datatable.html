<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Data Processing &amp; Visualization</title>
  <meta name="description" content="Data Processing &amp; Visualization in R">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="Data Processing &amp; Visualization" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://m-clark.github.io/" />
  <meta property="og:image" content="https://m-clark.github.io/img/nineteeneightyR.png" />
  <meta property="og:description" content="Data Processing &amp; Visualization in R" />
  <meta name="github-repo" content="m-clark/" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Data Processing &amp; Visualization" />
  
  <meta name="twitter:description" content="Data Processing &amp; Visualization in R" />
  <meta name="twitter:image" content="https://m-clark.github.io/img/nineteeneightyR.png" />



<meta name="date" content="2017-10-21">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  <link rel="shortcut icon" href="img/R.ico" type="image/x-icon">
<link rel="prev" href="07_tidyverse.html">
<link rel="next" href="09_thinkingvis.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-0.9/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.7.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotlyjs-1.29.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotlyjs-1.29.2/plotly-latest.min.js"></script>
<script src="libs/proj4js-2.3.15/proj4.js"></script>
<link href="libs/highcharts-5.0.6/css/motion.css" rel="stylesheet" />
<script src="libs/highcharts-5.0.6/highstock.js"></script>
<script src="libs/highcharts-5.0.6/highcharts-3d.js"></script>
<script src="libs/highcharts-5.0.6/highcharts-more.js"></script>
<script src="libs/highcharts-5.0.6/modules/annotations.js"></script>
<script src="libs/highcharts-5.0.6/modules/broken-axis.js"></script>
<script src="libs/highcharts-5.0.6/modules/data.js"></script>
<script src="libs/highcharts-5.0.6/modules/drilldown.js"></script>
<script src="libs/highcharts-5.0.6/modules/exporting.js"></script>
<script src="libs/highcharts-5.0.6/modules/funnel.js"></script>
<script src="libs/highcharts-5.0.6/modules/heatmap.js"></script>
<script src="libs/highcharts-5.0.6/modules/map.js"></script>
<script src="libs/highcharts-5.0.6/modules/no-data-to-display.js"></script>
<script src="libs/highcharts-5.0.6/modules/offline-exporting.js"></script>
<script src="libs/highcharts-5.0.6/modules/solid-gauge.js"></script>
<script src="libs/highcharts-5.0.6/modules/treemap.js"></script>
<script src="libs/highcharts-5.0.6/plugins/annotations.js"></script>
<script src="libs/highcharts-5.0.6/plugins/draggable-legend.js"></script>
<script src="libs/highcharts-5.0.6/plugins/draggable-points.js"></script>
<script src="libs/highcharts-5.0.6/plugins/export-csv.js"></script>
<script src="libs/highcharts-5.0.6/plugins/grouped-categories.js"></script>
<script src="libs/highcharts-5.0.6/plugins/motion.js"></script>
<script src="libs/highcharts-5.0.6/plugins/pattern-fill-v2.js"></script>
<script src="libs/highcharts-5.0.6/plugins/tooltip-delay.js"></script>
<script src="libs/highcharts-5.0.6/custom/reset.js"></script>
<script src="libs/highcharts-5.0.6/custom/symbols-extra.js"></script>
<script src="libs/highcharts-5.0.6/custom/text-symbols.js"></script>
<link href="libs/fontawesome-4.5.0/font-awesome.min.css" rel="stylesheet" />
<link href="libs/htmlwdgtgrid-1/htmlwdgtgrid.css" rel="stylesheet" />
<script src="libs/highchart-binding-0.5.0/highchart.js"></script>
<script src="libs/datatables-binding-0.2/datatables.js"></script>
<link href="libs/dt-core-1.10.12/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.12/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.12/js/jquery.dataTables.min.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="css\book.css" type="text/css" />
<link rel="stylesheet" href="css\standard_html.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://m-clark.github.io/"><span style="font-size:125%; font-variant:small-caps; font-style:italic; color:#990024; font-family:Roboto">Data Processing & Visualization</span></a></li>

<li class="divider"></li>
<li><a href="index.html#section"></a></li>
<li class="chapter" data-level="" data-path="01_intro.html"><a href="01_intro.html"><i class="fa fa-check"></i>Intro</a><ul>
<li class="chapter" data-level="" data-path="01_intro.html"><a href="01_intro.html#outline"><i class="fa fa-check"></i>Outline</a><ul>
<li class="chapter" data-level="" data-path="01_intro.html"><a href="01_intro.html#part-1-data-processing"><i class="fa fa-check"></i>Part 1: Data Processing</a></li>
<li class="chapter" data-level="" data-path="01_intro.html"><a href="01_intro.html#part-2-visualization"><i class="fa fa-check"></i>Part 2: Visualization</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="02_dataStructures.html"><a href="02_dataStructures.html"><i class="fa fa-check"></i>Part 1: Data Processing</a><ul>
<li class="chapter" data-level="" data-path="02_dataStructures.html"><a href="02_dataStructures.html#data-structures"><i class="fa fa-check"></i>Data Structures</a></li>
<li class="chapter" data-level="" data-path="03_io.html"><a href="03_io.html"><i class="fa fa-check"></i>Input/Output</a><ul>
<li class="chapter" data-level="" data-path="03_io.html"><a href="03_io.html#newer-approaches"><i class="fa fa-check"></i>Newer approaches</a></li>
<li class="chapter" data-level="" data-path="03_io.html"><a href="03_io.html#faster-approaches"><i class="fa fa-check"></i>Faster approaches</a></li>
<li class="chapter" data-level="" data-path="03_io.html"><a href="03_io.html#other-data"><i class="fa fa-check"></i>Other Data</a></li>
<li class="chapter" data-level="" data-path="03_io.html"><a href="03_io.html#on-the-horizon"><i class="fa fa-check"></i>On the horizon</a></li>
<li class="chapter" data-level="" data-path="03_io.html"><a href="03_io.html#big-data"><i class="fa fa-check"></i>Big Data</a></li>
<li><a href="03_io.html#io-exercises"><strong>I/O Exercises</strong></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="04_indexing.html"><a href="04_indexing.html"><i class="fa fa-check"></i>Indexing</a><ul>
<li class="chapter" data-level="" data-path="04_indexing.html"><a href="04_indexing.html#base-r-indexing-refresher"><i class="fa fa-check"></i>Base R Indexing Refresher</a></li>
<li class="chapter" data-level="" data-path="04_indexing.html"><a href="04_indexing.html#listdata.frame-extraction"><i class="fa fa-check"></i>List/Data.frame extraction</a></li>
<li><a href="04_indexing.html#indexing-exercises"><strong>Indexing Exercises</strong></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="05_vectorapp.html"><a href="05_vectorapp.html"><i class="fa fa-check"></i>Vectorization &amp; Apply</a><ul>
<li class="chapter" data-level="" data-path="05_vectorapp.html"><a href="05_vectorapp.html#boolean-indexing"><i class="fa fa-check"></i>Boolean Indexing</a></li>
<li class="chapter" data-level="" data-path="05_vectorapp.html"><a href="05_vectorapp.html#flexiblity"><i class="fa fa-check"></i>Flexiblity</a></li>
<li class="chapter" data-level="" data-path="05_vectorapp.html"><a href="05_vectorapp.html#vectorized-operations"><i class="fa fa-check"></i>Vectorized operations</a></li>
<li class="chapter" data-level="" data-path="05_vectorapp.html"><a href="05_vectorapp.html#apply-functions"><i class="fa fa-check"></i>Apply functions</a></li>
<li class="chapter" data-level="" data-path="05_vectorapp.html"><a href="05_vectorapp.html#example"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="05_vectorapp.html"><a href="05_vectorapp.html#timings"><i class="fa fa-check"></i>Timings</a></li>
<li class="chapter" data-level="" data-path="05_vectorapp.html"><a href="05_vectorapp.html#apply-functions-1"><i class="fa fa-check"></i>Apply functions</a></li>
<li class="chapter" data-level="" data-path="05_vectorapp.html"><a href="05_vectorapp.html#personal-experience"><i class="fa fa-check"></i>Personal experience</a></li>
<li class="chapter" data-level="" data-path="05_vectorapp.html"><a href="05_vectorapp.html#apply-functions-2"><i class="fa fa-check"></i>Apply functions</a></li>
<li><a href="05_vectorapp.html#vectorapply-exercises"><strong>Vector/Apply Exercises</strong></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="06_pipes.html"><a href="06_pipes.html"><i class="fa fa-check"></i>Pipes</a><ul>
<li class="chapter" data-level="" data-path="06_pipes.html"><a href="06_pipes.html#pipes-for-visualization-more-later"><i class="fa fa-check"></i>Pipes for Visualization (more later)</a></li>
<li class="chapter" data-level="" data-path="06_pipes.html"><a href="06_pipes.html#the-dot"><i class="fa fa-check"></i>The dot</a></li>
<li class="chapter" data-level="" data-path="06_pipes.html"><a href="06_pipes.html#flexibility"><i class="fa fa-check"></i>Flexibility</a></li>
<li class="chapter" data-level="" data-path="06_pipes.html"><a href="06_pipes.html#summary"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="07_tidyverse.html"><a href="07_tidyverse.html"><i class="fa fa-check"></i>Tidyverse</a><ul>
<li class="chapter" data-level="" data-path="07_tidyverse.html"><a href="07_tidyverse.html#what-is-the-tidyverse"><i class="fa fa-check"></i>What is the tidyverse?</a></li>
<li class="chapter" data-level="" data-path="07_tidyverse.html"><a href="07_tidyverse.html#what-is-tidy"><i class="fa fa-check"></i>What is tidy?</a></li>
<li class="chapter" data-level="" data-path="07_tidyverse.html"><a href="07_tidyverse.html#dplyr"><i class="fa fa-check"></i>dplyr</a></li>
<li class="chapter" data-level="" data-path="07_tidyverse.html"><a href="07_tidyverse.html#an-example"><i class="fa fa-check"></i>An example</a></li>
<li class="chapter" data-level="" data-path="07_tidyverse.html"><a href="07_tidyverse.html#an-alternative"><i class="fa fa-check"></i>An alternative</a></li>
<li class="chapter" data-level="" data-path="07_tidyverse.html"><a href="07_tidyverse.html#tidyr"><i class="fa fa-check"></i>tidyr</a></li>
<li class="chapter" data-level="" data-path="07_tidyverse.html"><a href="07_tidyverse.html#example-1"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="07_tidyverse.html"><a href="07_tidyverse.html#personal-opinion"><i class="fa fa-check"></i>Personal Opinion</a></li>
<li class="chapter" data-level="" data-path="07_tidyverse.html"><a href="07_tidyverse.html#on-the-horizon-1"><i class="fa fa-check"></i>On the horizon</a></li>
<li><a href="07_tidyverse.html#dplyr-exercises"><strong>dplyr Exercises</strong></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="08_datatable.html"><a href="08_datatable.html"><i class="fa fa-check"></i>data table</a><ul>
<li class="chapter" data-level="" data-path="08_datatable.html"><a href="08_datatable.html#grouped-operations"><i class="fa fa-check"></i>Grouped operations</a></li>
<li class="chapter" data-level="" data-path="08_datatable.html"><a href="08_datatable.html#faster"><i class="fa fa-check"></i>Faster!</a></li>
<li class="chapter" data-level="" data-path="08_datatable.html"><a href="08_datatable.html#timings-1"><i class="fa fa-check"></i>Timings</a></li>
<li class="chapter" data-level="" data-path="08_datatable.html"><a href="08_datatable.html#pipe-with-data.table"><i class="fa fa-check"></i>Pipe with data.table</a></li>
<li class="chapter" data-level="" data-path="08_datatable.html"><a href="08_datatable.html#my-take"><i class="fa fa-check"></i>My take</a></li>
<li class="chapter" data-level="" data-path="08_datatable.html"><a href="08_datatable.html#compromise"><i class="fa fa-check"></i>Compromise</a></li>
<li class="chapter" data-level="" data-path="08_datatable.html"><a href="08_datatable.html#dtplyr"><i class="fa fa-check"></i>dtplyr</a></li>
<li><a href="08_datatable.html#data.table-exercises"><strong>data.table Exercises</strong></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="09_thinkingvis.html"><a href="09_thinkingvis.html"><i class="fa fa-check"></i>Part II: Visualization</a><ul>
<li class="chapter" data-level="" data-path="09_thinkingvis.html"><a href="09_thinkingvis.html#thinking-visually"><i class="fa fa-check"></i>Thinking Visually</a><ul>
<li class="chapter" data-level="" data-path="09_thinkingvis.html"><a href="09_thinkingvis.html#information"><i class="fa fa-check"></i>Information</a></li>
<li class="chapter" data-level="" data-path="09_thinkingvis.html"><a href="09_thinkingvis.html#color"><i class="fa fa-check"></i>Color</a></li>
<li class="chapter" data-level="" data-path="09_thinkingvis.html"><a href="09_thinkingvis.html#contrast"><i class="fa fa-check"></i>Contrast</a></li>
<li class="chapter" data-level="" data-path="09_thinkingvis.html"><a href="09_thinkingvis.html#webaxe"><i class="fa fa-check"></i>WebAxe</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="10_ggplot2.html"><a href="10_ggplot2.html"><i class="fa fa-check"></i>ggplot2</a><ul>
<li class="chapter" data-level="" data-path="10_ggplot2.html"><a href="10_ggplot2.html#aesthetics"><i class="fa fa-check"></i>Aesthetics</a></li>
<li class="chapter" data-level="" data-path="10_ggplot2.html"><a href="10_ggplot2.html#layers"><i class="fa fa-check"></i>Layers</a></li>
<li class="chapter" data-level="" data-path="10_ggplot2.html"><a href="10_ggplot2.html#piping"><i class="fa fa-check"></i>Piping</a></li>
<li class="chapter" data-level="" data-path="10_ggplot2.html"><a href="10_ggplot2.html#examples"><i class="fa fa-check"></i>Examples</a></li>
<li class="chapter" data-level="" data-path="10_ggplot2.html"><a href="10_ggplot2.html#stats"><i class="fa fa-check"></i>Stats</a></li>
<li class="chapter" data-level="" data-path="10_ggplot2.html"><a href="10_ggplot2.html#facets"><i class="fa fa-check"></i>Facets</a></li>
<li class="chapter" data-level="" data-path="10_ggplot2.html"><a href="10_ggplot2.html#fine-control"><i class="fa fa-check"></i>Fine control</a></li>
<li class="chapter" data-level="" data-path="10_ggplot2.html"><a href="10_ggplot2.html#extensions"><i class="fa fa-check"></i>Extensions</a></li>
<li class="chapter" data-level="" data-path="10_ggplot2.html"><a href="10_ggplot2.html#summary-ggplot2"><i class="fa fa-check"></i>Summary ggplot2</a></li>
<li><a href="10_ggplot2.html#ggplot2-exercises"><strong>ggplot2 Exercises</strong></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="11_interactive.html"><a href="11_interactive.html"><i class="fa fa-check"></i>Interactive Visualization</a><ul>
<li class="chapter" data-level="" data-path="11_interactive.html"><a href="11_interactive.html#packages"><i class="fa fa-check"></i>Packages</a></li>
<li class="chapter" data-level="" data-path="11_interactive.html"><a href="11_interactive.html#piping-for-visualization"><i class="fa fa-check"></i>Piping for Visualization</a></li>
<li class="chapter" data-level="" data-path="11_interactive.html"><a href="11_interactive.html#htmlwidgets"><i class="fa fa-check"></i>htmlwidgets</a></li>
<li class="chapter" data-level="" data-path="11_interactive.html"><a href="11_interactive.html#plotly-example"><i class="fa fa-check"></i>plotly example</a></li>
<li class="chapter" data-level="" data-path="11_interactive.html"><a href="11_interactive.html#ggplotly"><i class="fa fa-check"></i>ggplotly</a></li>
<li class="chapter" data-level="" data-path="11_interactive.html"><a href="11_interactive.html#highcharter"><i class="fa fa-check"></i>Highcharter</a></li>
<li class="chapter" data-level="" data-path="11_interactive.html"><a href="11_interactive.html#visnetwork"><i class="fa fa-check"></i>visNetwork</a></li>
<li class="chapter" data-level="" data-path="11_interactive.html"><a href="11_interactive.html#data-table-1"><i class="fa fa-check"></i>data table</a></li>
<li class="chapter" data-level="" data-path="11_interactive.html"><a href="11_interactive.html#shiny"><i class="fa fa-check"></i>Shiny</a></li>
<li class="chapter" data-level="" data-path="11_interactive.html"><a href="11_interactive.html#interactive-and-visual-data-exploration"><i class="fa fa-check"></i>Interactive and Visual Data Exploration</a></li>
<li><a href="11_interactive.html#interactive-visualization-exercises"><strong>Interactive Visualization Exercises</strong></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="999_summary.html"><a href="999_summary.html"><i class="fa fa-check"></i>Summary</a></li>
<li class="divider"></li>
<li><a href="https://m-clark.github.io/"><img src="img/mc.png" style="width:50%; padding:0px 0; display:block; margin: 0 auto;" alt="MC logo"></a></li>
<li><a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="width:50%; border-width:0; display:block; margin: 0 auto;" src="img/ccbysa_test.png" /></a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><span style="font-size:125%; font-family:Roboto; font-style:normal">Data Processing &amp; Visualization</span></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-table" class="section level2">
<h2>data table</h2>
<!-- whatever you do, don't put a dot in the title or it will read nothing beyond the title; no, escapes, quotes nor spans won't work because that would make sense. -->
<p><span class="pack">data.table</span> works in a notably different way than <span class="pack">dplyr</span>. However, you’d use it for the same reasons.</p>
<p>Like <span class="pack">dplyr</span>, the data objects are both <span class="objclass">data.frames</span> and a package specific class.</p>
<p>Faster subset, grouping, update, ordered joins etc.</p>
<p>In general, <span class="pack">data.table</span> works with brackets as in base R.</p>
<p>However, the brackets work like a function call!</p>
<ul>
<li>Several key arguments</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x[i, j, by, keyby, with =<span class="st"> </span><span class="ot">TRUE</span>, ...]</code></pre></div>
<p>Importantly: <em>you don’t use the brackets as you would with data.frames</em>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(data.table)
dt =<span class="st"> </span><span class="kw">data.table</span>(<span class="dt">x=</span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dv">6</span>), <span class="dt">g=</span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">y=</span><span class="kw">runif</span>(<span class="dv">6</span>))
<span class="kw">class</span>(dt)</code></pre></div>
<pre><code>[1] &quot;data.table&quot; &quot;data.frame&quot;</code></pre>
<p>What <strong>i</strong> and <strong>j</strong> can be are fairly complex.</p>
<p>In general, you use <strong>i</strong> for filtering by rows.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dt[<span class="dv">2</span>]
dt[<span class="dv">2</span>,]</code></pre></div>
<pre><code>   x g         y
1: 4 2 0.1195698
   x g         y
1: 4 2 0.1195698</code></pre>
<p>In general, you use <strong>j</strong> to select (by name!) or create new columns.</p>
<ul>
<li>Define a new variable with <span class="func">:=</span></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dt[,x]
dt[,z <span class="op">:</span><span class="er">=</span><span class="st"> </span>x<span class="op">+</span>y]  <span class="co"># dt now has a new column</span>
dt[,z]
dt[g<span class="op">&gt;</span><span class="dv">1</span>, <span class="kw">mean</span>(z), by=g]
dt</code></pre></div>
<pre><code>[1] 10  4  6  9  2  3
[1] 10.372553  4.119570  6.332344  9.751102  2.109955  3.948890
   g       V1
1: 2 3.114762
2: 3 5.140617
    x g         y         z
1: 10 1 0.3725530 10.372553
2:  4 2 0.1195698  4.119570
3:  6 3 0.3323439  6.332344
4:  9 1 0.7511015  9.751102
5:  2 2 0.1099548  2.109955
6:  3 3 0.9488896  3.948890</code></pre>
<p>Dropping columns is awkward.</p>
<ul>
<li>because <strong>j</strong> is an argument</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dt[,<span class="op">-</span>y]             <span class="co"># creates negative values of y</span>
dt[,<span class="op">-</span><span class="st">&#39;y&#39;</span>, with=F]   <span class="co"># drops y, but now needs quotes</span>
## dt[,y:=NULL]        # drops y, but this is just a base R approach
## dt$y = NULL</code></pre></div>
<pre><code>[1] -0.3725530 -0.1195698 -0.3323439 -0.7511015 -0.1099548 -0.9488896
    x g         z
1: 10 1 10.372553
2:  4 2  4.119570
3:  6 3  6.332344
4:  9 1  9.751102
5:  2 2  2.109955
6:  3 3  3.948890</code></pre>
<div id="grouped-operations" class="section level3">
<h3>Grouped operations</h3>
<p>We can now attempt a ‘group-by’ operation, along with creation of a new variable.</p>
<p>Note that these operations actually modify <span class="objclass">dt</span> <em>in place</em>, a key distinction with <span class="pack">dplyr</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dt1 =<span class="st"> </span>dt2 =<span class="st"> </span>dt
dt[,<span class="kw">sum</span>(x,y), by=g]                  <span class="co"># sum of all x and y values</span></code></pre></div>
<pre><code>   g        V1
1: 1 20.123655
2: 2  6.229525
3: 3 10.281233</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dt1[,newvar <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">sum</span>(x), by=g]         <span class="co"># add new variable to the original data </span></code></pre></div>
<p>We can also create groupings on the fly.</p>
<p>For a new summary data set, we’ll take the following approach.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dt2[, <span class="kw">list</span>(<span class="dt">meanx =</span> <span class="kw">mean</span>(x), <span class="dt">sumx =</span> <span class="kw">sum</span>(x)), by=g<span class="op">==</span><span class="dv">1</span>]</code></pre></div>
<pre><code>       g meanx sumx
1:  TRUE  9.50   19
2: FALSE  3.75   15</code></pre>
</div>
<div id="faster" class="section level3">
<h3>Faster!</h3>
<ul>
<li>joins: and easy to do (note that i can be a data.table)</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dt1[dt2]</code></pre></div>
<ul>
<li>group operations: via <span class="func">setkey</span></li>
<li>reading files: <span class="func">fread</span></li>
<li>character matches: e.g. via <span class="func">chmatch</span></li>
</ul>
</div>
<div id="timings-1" class="section level3">
<h3>Timings</h3>
<p>The following demonstrates some timings from <a href="http://stackoverflow.com/questions/3505701/r-grouping-functions-sapply-vs-lapply-vs-apply-vs-tapply-vs-by-vs-aggrega/34167477#34167477">here</a>.</p>
<ul>
<li>Reproduced on my own machine</li>
<li>based on 50 million observations</li>
<li>Grouped operations are just a sum and length on a vector.</li>
</ul>
<p>By the way, never, ever use <span class="func">aggregate</span>. For anything.</p>
<pre><code>          fun elapsed
1:  aggregate  114.35
2:         by   24.51
3:     sapply   11.62
4:     tapply   11.33
5:      dplyr   10.97
6:     lapply   10.65
7: data.table    2.71</code></pre>
<p>Ever.</p>
<p>Really.</p>
</div>
<div id="pipe-with-data.table" class="section level3">
<h3>Pipe with data.table</h3>
<p>Can be done but awkward at best.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mydt[,newvar<span class="op">:</span><span class="er">=</span><span class="kw">mean</span>(x),][,newvar2<span class="op">:</span><span class="er">=</span><span class="kw">sum</span>(newvar), by=group][,<span class="op">-</span><span class="st">&#39;y&#39;</span>, with=<span class="ot">FALSE</span>]
mydt[,newvar<span class="op">:</span><span class="er">=</span><span class="kw">mean</span>(x), 
  ][,newvar2<span class="op">:</span><span class="er">=</span><span class="kw">sum</span>(newvar), by=group
  ][,<span class="op">-</span><span class="st">&#39;y&#39;</span>, with=<span class="ot">FALSE</span>
  ]</code></pre></div>
<p>Probably better to just use a pipe and dot approach.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mydt[,newvar<span class="op">:</span><span class="er">=</span><span class="kw">mean</span>(x),] <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>.[,newvar2<span class="op">:</span><span class="er">=</span><span class="kw">sum</span>(newvar), by=group] <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>.[,<span class="op">-</span><span class="st">&#39;y&#39;</span>, with=<span class="ot">FALSE</span>]</code></pre></div>
</div>
<div id="my-take" class="section level3">
<h3>My take</h3>
<p>Faster methods are great to have.</p>
<ul>
<li>Especially for group-by and joins.</li>
</ul>
<p>Drawbacks:</p>
<ul>
<li>Complex</li>
<li>The syntax can be awkward</li>
<li>It doesn’t work like a data.frame</li>
<li>Piping with brackets</li>
<li>Does not have its own ‘verse’</li>
</ul>
</div>
<div id="compromise" class="section level3">
<h3>Compromise</h3>
<p>If speed and/or memory is (potentially) a concern, data.table</p>
<p>For interactive exploration, dplyr</p>
<p>Piping allows one to use both, so no need to choose.</p>
<p>And on the horizon…</p>
</div>
<div id="dtplyr" class="section level3">
<h3>dtplyr</h3>
<p>Coming soon to an R near you.</p>
<blockquote>
<p>This implements the data table back-end for ‘dplyr’ so that you can seamlessly use data table and ‘dplyr’ together.</p>
</blockquote>
<p>Or play with now. The following shows times for a grouped operation of a data frame of two variables, a random uniform draw of 5e7 values, and a grouping variable of 500k groups.</p>
<table style="width:29%;">
<colgroup>
<col width="18%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">package</th>
<th align="center">timing</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">dplyr</td>
<td align="center">10.97</td>
</tr>
<tr class="even">
<td align="center">data.table</td>
<td align="center">2.71</td>
</tr>
<tr class="odd">
<td align="center">dtplyr</td>
<td align="center">2.7</td>
</tr>
</tbody>
</table>
<p>Just for giggles I did the same in python with a pandas DataFrame and groupby operation, and it took 7+ seconds.</p>
</div>
<div id="data.table-exercises" class="section level3">
<h3><strong>data.table Exercises</strong></h3>
<div id="exercise-0-1" class="section level4">
<h4>Exercise 0</h4>
<p>Install and load the <span class="pack">data.table</span> package.</p>
<p>Create the following data table.</p>
<pre><code>mydt = data.table(expand.grid(x=1:3, y=c(&#39;a&#39;,&#39;b&#39;,&#39;c&#39;)), z=sample(1:20, 9))</code></pre>
</div>
<div id="exercise-1-4" class="section level4">
<h4>Exercise 1</h4>
<p>Create a new object that contains only the ‘a’ group. Think back to how you use a logical to select rows.</p>
</div>
<div id="exercise-2-4" class="section level4">
<h4>Exercise 2</h4>
<p>Create a new object that is the sum of z grouped by x. You don’t need to name the sum variable.</p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="07_tidyverse.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="09_thinkingvis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["twitter", "facebook", "google", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"download": null,
"toc": {
"collapse": "subsection",
"depth": 2,
"scroll_highlight": true
},
"highlight": "pygments",
"search": true
});
});
</script>

</body>

</html>
